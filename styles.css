/* --- Base & Variables --- */
:root {
    --bg-light: 248 250 252; /* slate-50 (lighter) */
    --bg-dark: 15 23 42;    /* slate-900 */
    --surface-light: 255 255 255; /* white */
    --surface-dark: 30 41 59; /* slate-800 */
    --surface-dark-secondary: 51 65 85; /* slate-700 for slightly lighter dark elements */

    --text-light-primary: 15 23 42; /* slate-900 */
    --text-dark-primary: 241 245 249; /* slate-100 */
    --text-light-secondary: 71 85 105; /* slate-600 */
    --text-dark-secondary: 148 163 184; /* slate-400 */

    --border-light: 226 232 240; /* slate-200 */
    --border-dark: 51 65 85; /* slate-700 */

    --accent-color: 79 70 229; /* indigo-600 */
    --accent-color-dark: 99 102 241; /* indigo-400 */
    --accent-text-light: 255 255 255;
    --accent-text-dark: 224 231 255; /* indigo-100 */

    /* Neumorphism Shadows (Light) - Softer */
    --neumorph-shadow-light-outer: 4px 4px 8px rgba(var(--border-light), 0.7), -4px -4px 8px rgba(255,255,255,1);
    --neumorph-shadow-light-inner: inset 3px 3px 5px rgba(var(--border-light), 0.7), inset -3px -3px 5px rgba(255,255,255,1);
    /* Neumorphism Shadows (Dark) - More defined */
    --neumorph-shadow-dark-outer: 5px 5px 12px rgba(0,0,0,0.5), -5px -5px 12px rgba(75,85,100,0.15);
    --neumorph-shadow-dark-inner: inset 4px 4px 8px rgba(0,0,0,0.5), inset -4px -4px 8px rgba(75,85,100,0.15);

    /* Glassmorphism - More blur, adjusted transparency for "gloss" */
    --glass-blur: 18px; /* Increased blur */
    --glass-bg-light: rgba(var(--surface-light), 0.75); /* Slightly more opaque */
    --glass-bg-dark: rgba(40, 50, 70, 0.65); /* Custom dark glass, slightly bluish */
    --glass-border-light: rgba(var(--surface-light), 0.4);
    --glass-border-dark: rgba(var(--surface-light), 0.15);
    --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
    --glass-shadow-dark: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
}

html.dark {
    color-scheme: dark;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: rgb(var(--bg-light));
    color: rgb(var(--text-light-primary));
    min-height: 100vh;
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    transition: background-color 0.3s ease-in-out, color 0.3s ease-in-out, background-image 0.5s ease-in-out;
}

.dark body {
    background-color: rgb(var(--bg-dark));
    color: rgb(var(--text-dark-primary));
}

/* --- Loader --- */
.loader {
    border: 4px solid rgba(var(--border-light), 0.3);
    border-top: 4px solid rgb(var(--accent-color));
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}
.dark .loader {
    border: 4px solid rgba(var(--border-dark), 0.3);
    border-top: 4px solid rgb(var(--accent-color-dark));
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* --- Animations --- */
.fade-in { animation: fadeInAnimation 0.5s ease-in forwards; }
.fade-out { animation: fadeOutAnimation 0.5s ease-out forwards; }
@keyframes fadeInAnimation {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeOutAnimation {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(10px); }
}

/* --- Glassmorphism & Neumorphism Base --- */
.content-bg {
    background-color: var(--glass-bg-light);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border: 1px solid var(--glass-border-light);
    border-radius: 0.75rem;
    box-shadow: var(--glass-shadow);
    transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
}
.dark .content-bg {
    background-color: var(--glass-bg-dark);
    border: 1px solid var(--glass-border-dark);
    box-shadow: var(--glass-shadow-dark);
}

.btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 0.15s ease-in-out;
    background-color: rgb(var(--bg-light));
    color: rgb(var(--text-light-primary));
    box-shadow: var(--neumorph-shadow-light-outer);
    border: 1px solid transparent;
}
.dark .btn {
    background-color: rgb(var(--surface-dark-secondary));
    color: rgb(var(--text-dark-primary));
    box-shadow: var(--neumorph-shadow-dark-outer);
}
.btn:hover { transform: translateY(-1px); filter: brightness(1.05); }
.dark .btn:hover { filter: brightness(1.15); }
.btn:active, .btn.active { box-shadow: var(--neumorph-shadow-light-inner); transform: translateY(1px); filter: brightness(0.95); }
.dark .btn:active, .dark .btn.active { box-shadow: var(--neumorph-shadow-dark-inner); filter: brightness(0.85); }

.btn-primary { background-color: rgb(var(--accent-color)); color: var(--accent-text-light); }
.dark .btn-primary { background-color: rgb(var(--accent-color-dark)); color: var(--accent-text-dark); }
.btn-primary:hover { background-color: rgba(var(--accent-color), 0.9); }
.dark .btn-primary:hover { background-color: rgba(var(--accent-color-dark), 0.9); }

.btn-secondary { background-color: #94a3b8; color: rgb(var(--text-light-primary)); } /* slate-400 */
.dark .btn-secondary { background-color: #475569; color: rgb(var(--text-dark-primary));} /* slate-600 */
.btn-secondary:hover { background-color: #64748b; } /* slate-500 */
.dark .btn-secondary:hover { background-color: #334155; }

.btn-success { background-color: #22c55e; color: white; } /* green-500 */
.dark .btn-success { background-color: #16a34a; color: rgb(var(--text-dark-primary));} /* green-600 */
.btn-success:hover { background-color: #16a34a; }
.dark .btn-success:hover { background-color: #15803d; }

.btn-neutral { background-color: #d4d4d8; color: rgb(var(--text-light-primary)); } /* zinc-300 */
.dark .btn-neutral { background-color: #52525b; color: rgb(var(--text-dark-primary));} /* zinc-600 */
.btn-neutral:hover { background-color: #a1a1aa; }
.dark .btn-neutral:hover { background-color: #3f3f46; }


.input-field, .form-checkbox, select.input-field {
    border-radius: 0.5rem;
    background-color: rgb(var(--bg-light));
    color: rgb(var(--text-light-primary));
    border: 1px solid rgba(var(--border-light), 0.5);
    box-shadow: var(--neumorph-shadow-light-inner);
    transition: all 0.2s ease-in-out;
}
.dark .input-field, .dark .form-checkbox, .dark select.input-field {
    background-color: rgb(var(--surface-dark));
    color: rgb(var(--text-dark-primary));
    border-color: rgba(var(--border-dark), 0.5);
    box-shadow: var(--neumorph-shadow-dark-inner);
}
.input-field::placeholder { color: rgb(var(--text-light-secondary)); opacity: 0.7; }
.dark .input-field::placeholder { color: rgb(var(--text-dark-secondary)); opacity: 0.7; }

.input-field:focus, select.input-field:focus {
    box-shadow: var(--neumorph-shadow-light-outer), 0 0 0 2px rgba(var(--accent-color), 0.3);
    border-color: rgb(var(--accent-color));
    outline: none;
}
.dark .input-field:focus, .dark select.input-field:focus {
    box-shadow: var(--neumorph-shadow-dark-outer), 0 0 0 2px rgba(var(--accent-color-dark), 0.3);
    border-color: rgb(var(--accent-color-dark));
}
.form-checkbox { appearance: none; -webkit-appearance: none; height: 1.25rem; width: 1.25rem; cursor: pointer; }
.form-checkbox:checked { background-color: rgb(var(--accent-color)); border-color: rgb(var(--accent-color)); box-shadow: var(--neumorph-shadow-light-inner), inset 0 0 0 3px rgb(var(--bg-light)); }
.dark .form-checkbox:checked { background-color: rgb(var(--accent-color-dark)); border-color: rgb(var(--accent-color-dark)); box-shadow: var(--neumorph-shadow-dark-inner), inset 0 0 0 3px rgb(var(--surface-dark)); }


/* --- Navigation --- */
#mainNav {
    background-color: var(--glass-bg-light);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border-bottom: 1px solid var(--glass-border-light);
    box-shadow: var(--glass-shadow);
}
.dark #mainNav {
    background-color: var(--glass-bg-dark);
    border-bottom: 1px solid var(--glass-border-dark);
    box-shadow: var(--glass-shadow-dark);
}
.nav-link { color: rgb(var(--text-light-secondary)); }
.dark .nav-link { color: rgb(var(--text-dark-secondary)); }
.nav-link:hover { color: rgb(var(--accent-color)); }
.dark .nav-link:hover { color: rgb(var(--accent-color-dark)); }
.nav-link.active { border-bottom: 2px solid rgb(var(--accent-color)); color: rgb(var(--accent-color)); font-weight: 600; }
.dark .nav-link.active { border-bottom-color: rgb(var(--accent-color-dark)); color: rgb(var(--accent-color-dark)); }

#darkModeToggle {
    background-color: transparent;
    box-shadow: none;
    color: rgb(var(--text-light-secondary));
}
.dark #darkModeToggle {
    color: rgb(var(--text-dark-secondary));
}
#darkModeToggle:hover { background-color: rgba(var(--border-light), 0.5); }
.dark #darkModeToggle:hover { background-color: rgba(var(--border-dark), 0.5); }


/* --- Event Cards & Sidebar --- */
.event-card, .sidebar-event-card, .canvas-item-card {
    border-radius: 0.75rem;
    background-color: rgba(var(--surface-light), 0.95); /* More opaque for readability */
    border: 1px solid rgba(var(--border-light), 0.4);
    box-shadow: 0 4px 12px rgba(0,0,0,0.03); /* Softer shadow */
    color: rgb(var(--text-light-primary));
}
.dark .event-card, .dark .sidebar-event-card, .dark .canvas-item-card {
    background-color: rgba(var(--surface-dark-secondary), 0.85); /* Slightly lighter dark for cards */
    border: 1px solid rgba(var(--border-dark), 0.5);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    color: rgb(var(--text-dark-primary));
}

/* --- Weekly View Specifics --- */
#calendarDisplayWeek { overflow-x: auto; }
.weekly-grid-container { position: relative; padding-top: 40px; }
.weekly-grid { display: grid; grid-template-columns: 60px repeat(5, minmax(100px, 1fr)); grid-auto-rows: 60px; gap: 1px; background-color: rgba(var(--border-light), 0.2); border: 1px solid rgba(var(--border-light), 0.2); border-radius: 4px; }
.dark .weekly-grid { background-color: rgba(var(--border-dark), 0.2); border-color: rgba(var(--border-dark), 0.2); }
.grid-header { font-weight: 600; text-align: center; padding: 8px 4px; background-color: rgba(var(--accent-color), 0.05); color: rgb(var(--accent-color)); font-size: 0.875rem; position: sticky; top: 0; z-index: 20; height: 40px; border-bottom: 1px solid rgba(var(--border-light), 0.2); }
.dark .grid-header { background-color: rgba(var(--accent-color-dark), 0.1); color: rgb(var(--accent-color-dark)); border-bottom-color: rgba(var(--border-dark), 0.2); }
.time-slot { font-size: 0.75rem; text-align: right; padding: 0 4px; color: rgb(var(--text-light-secondary)); background-color: rgba(var(--surface-light), 0.7); display: flex; align-items: center; justify-content: flex-end; border-top: 1px solid rgba(var(--border-light),0.15); grid-column: 1 / 2; }
.dark .time-slot { color: rgb(var(--text-dark-secondary)); background-color: rgba(var(--surface-dark), 0.6); border-top-color: rgba(var(--border-dark),0.15); }
.day-column-bg { background-color: rgba(var(--surface-light),0.3); border-top: 1px solid rgba(var(--border-light),0.15); }
.dark .day-column-bg { background-color: rgba(var(--surface-dark),0.25); border-top-color: rgba(var(--border-dark),0.15); }
.day-column-content { grid-column: span 1; grid-row: 1 / -1; position: relative; border-left: 1px solid rgba(var(--border-light),0.15); background-color: transparent; }
.dark .day-column-content { border-left-color: rgba(var(--border-dark),0.15); }
.day-column-content[data-day-index="0"] { grid-column: 2 / 3; }
.day-column-content[data-day-index="1"] { grid-column: 3 / 4; }
.day-column-content[data-day-index="2"] { grid-column: 4 / 5; }
.day-column-content[data-day-index="3"] { grid-column: 5 / 6; }
.day-column-content[data-day-index="4"] { grid-column: 6 / 7; }
.week-event { position: absolute; left: 2px; right: 2px; font-size: 0.7rem; line-height: 1.2; padding: 2px 4px; border-radius: 4px; border: 1px solid rgba(0,0,0,0.1); overflow: hidden; cursor: default; box-shadow: 0 1px 3px rgba(0,0,0,0.05); z-index: 10; opacity: 1; transform: translateY(0); }
.dark .week-event { border-color: rgba(255,255,255,0.1); } /* Lighter border for events in dark mode */
.week-event.clickable-week-event { cursor: pointer; }
.week-event.fade-in { animation: fadeInAnimation 0.5s ease-in forwards; }
.week-event:hover { filter: brightness(1.1); }
.dark .week-event:hover { filter: brightness(1.2); }
.week-event.canvas-assignment-event { border-left: 3px solid #e53e3e; background-color: #fee2e2 !important; } /* Light red for canvas assignments */
.dark .week-event.canvas-assignment-event { background-color: #521b1b !important; border-left-color: #f87171; color: #fecaca !important; } /* Darker red for canvas assignments in dark mode */


/* --- Sidebar Specifics --- */
#sidebar { /* Glassmorphism applied via .content-bg */ }
.sidebar-event-card { background-color: rgba(var(--surface-light), 0.8); border-left: 4px solid rgb(var(--text-light-secondary)); }
.dark .sidebar-event-card { background-color: rgba(var(--surface-dark-secondary), 0.7); border-left-color: rgb(var(--text-dark-secondary)); }
.sidebar-event-card.canvas-assignment { border-left-color: #e53e3e; background-color: #fee2e2; }
.dark .sidebar-event-card.canvas-assignment { border-left-color: #ef4444; background-color: #521b1b; }

#liveClock {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    background-color: rgb(var(--bg-light));
    box-shadow: var(--neumorph-shadow-light-inner);
    color: rgb(var(--accent-color));
    font-family: 'Courier New', Courier, monospace;
}
.dark #liveClock {
    background-color: rgb(var(--surface-dark));
    box-shadow: var(--neumorph-shadow-dark-inner);
    color: rgb(var(--accent-color-dark));
}
#canvasClassListSidebar h3, #sidebar h3 {
    color: rgb(var(--text-light-primary));
}
.dark #canvasClassListSidebar h3, .dark #sidebar h3 {
    color: rgb(var(--text-dark-primary));
}
#canvasClassListContainer a {
    display: block;
    padding: 0.3rem 0.5rem;
    border-radius: 0.375rem;
    color: rgb(var(--text-light-secondary));
    transition: background-color 0.2s, color 0.2s;
}
#canvasClassListContainer a:hover {
    background-color: rgba(var(--accent-color), 0.1);
    color: rgb(var(--accent-color));
}
.dark #canvasClassListContainer a {
    color: rgb(var(--text-dark-secondary));
}
.dark #canvasClassListContainer a:hover {
    background-color: rgba(var(--accent-color-dark), 0.2);
    color: rgb(var(--accent-color-dark));
}
.canvas-class-next-time {
    font-size: 0.7rem;
    color: rgb(var(--text-light-secondary));
    margin-left: 0.5rem;
}
.dark .canvas-class-next-time {
    color: rgb(var(--text-dark-secondary));
}


/* --- Status Indicator --- */
.status-indicator { display: flex; align-items: center; font-size: 0.8rem; margin-top: -1rem; margin-bottom: 1rem; }
.status-icon { width: 10px; height: 10px; border-radius: 50%; margin-right: 6px; }
.status-icon.live { background-color: #10b981; }
.status-icon.failed svg { width: 12px; height: 12px; color: #f97316; }
.status-text { color: rgb(var(--text-light-secondary)); }
.dark .status-text { color: rgb(var(--text-dark-secondary)); }
.status-text.failed { color: #f97316; font-weight: 500; }
.dark .status-text.failed { color: #fb923c; }


/* --- Notification Settings --- */
.notification-preference { display: flex; align-items: center; margin-bottom: 0.5rem; }
.notification-preference label { margin-right: 0.5rem; min-width: 150px; color: rgb(var(--text-light-primary));}
.dark .notification-preference label { color: rgb(var(--text-dark-primary));}
.notification-preference input[type="checkbox"] { margin-right: 0.5rem; }
.notification-preference input[type="number"] { width: 70px; padding: 0.25rem 0.5rem; }


/* --- Time Indicators --- */
.time-indicator {
    font-size: 0.7rem;
    font-weight: 500;
    padding: 0.1rem 0.3rem;
    border-radius: 0.25rem;
    margin-left: 0.5rem;
    display: inline-block;
}
.time-indicator-now {
    background-color: #facc15; /* yellow-400 */
    color: #713f12; /* yellow-800 */
}
.dark .time-indicator-now {
    background-color: #eab308; /* yellow-500 */
    color: #422006; /* yellow-900 */
}
.time-indicator-upcoming {
    background-color: #a7f3d0; /* green-200 */
    color: #047857; /* green-700 */
}
.dark .time-indicator-upcoming {
    background-color: #34d399; /* green-400 */
    color: #064e3b; /* green-800 */
}

/* Ensure select dropdown text is visible in dark mode */
select.input-field option {
    background-color: rgb(var(--surface-light));
    color: rgb(var(--text-light-primary));
}
.dark select.input-field option {
    background-color: rgb(var(--surface-dark-secondary));
    color: rgb(var(--text-dark-primary));
}

/* General link styling */
a {
    color: rgb(var(--accent-color));
    text-decoration: none;
}
a:hover {
    text-decoration: underline;
}
.dark a {
    color: rgb(var(--accent-color-dark));
}

/* Specific overrides for better dark mode readability on colored event cards */
.dark .event-card strong, .dark .week-event strong {
    /* This is a general approach. isColorDark in JS is more precise */
    /* color: rgb(var(--text-dark-primary)); */
}
.dark .event-card span, .dark .week-event span {
    /* color: rgb(var(--text-dark-secondary)); */
}

/* Ensure icons within colored cards are also readable in dark mode */
.dark .event-card svg, .dark .week-event svg {
    /* color: rgb(var(--text-dark-secondary)); */
}

